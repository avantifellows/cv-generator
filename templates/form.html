<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }
        .section h2 {
            color: #4a5568;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input[type="text"], input[type="email"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            height: 80px;
            resize: vertical;
        }
        .row {
            display: flex;
            gap: 15px;
        }
        .col {
            flex: 1;
        }
        button {
            background-color: #4299e1;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        button:hover {
            background-color: #3182ce;
        }
        .required {
            color: red;
        }
        .dynamic-entry {
            border: 1px solid #e2e8f0;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            background-color: white;
            position: relative;
        }
        .entry-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .entry-title {
            font-weight: bold;
            color: #2d3748;
        }
        .btn-secondary {
            background-color: #48bb78;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        .btn-secondary:hover {
            background-color: #38a169;
        }
        .btn-danger {
            background-color: #e53e3e;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
            min-width: 80px;
            max-width: 120px;
        }
        .btn-danger:hover {
            background-color: #c53030;
        }
        .add-button-container {
            text-align: center;
            margin-top: 15px;
        }
        .point-input {
            margin-bottom: 10px;
        }
        .points-container {
            margin-top: 10px;
        }
        .point-entry {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .point-entry textarea {
            flex: 1;
            height: 60px;
            width: 100%;
        }
        .point-entry .btn-danger {
            flex-shrink: 0;
            width: auto;
            min-width: 80px;
            padding: 8px 12px;
        }
        .skill-entry {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .skill-entry input {
            flex: 1;
            width: 100%;
        }
        .skill-entry .btn-danger {
            flex-shrink: 0;
            width: auto;
            min-width: 80px;
            padding: 8px 12px;
        }
        .activity-entry {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
        }
        .activity-entry textarea {
            flex: 1;
            height: 60px;
            width: 100%;
        }
        .activity-entry .btn-danger {
            flex-shrink: 0;
            width: auto;
            min-width: 80px;
            padding: 8px 12px;
        }
        .main-flex {
        display: flex;
        gap: 32px;
        align-items: flex-start;
        justify-content: center;
    }
    .form-section, .preview-section {
        flex: 0 0 600px;
        max-width: 600px;
        min-width: 350px;
        box-sizing: border-box;
    }
    #cv-preview-container {
        width: 100%;
        height: 1123px;
        border: 1px solid #ccc;
        background: #fff;
        overflow: auto;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    @media (max-width: 1300px) {
        .main-flex {
            flex-direction: column;
            align-items: stretch;
        }
        .form-section, .preview-section {
            max-width: 100%;
            flex: 1 1 100%;
        }
    }
    </style>
</head>
<body>
    <div class="main-flex">
        <div class="form-section">
    <div class="container">
        <h1>CV Generator</h1>
        <form id="cvForm" method="post" action="/generate">
            
            <!-- Personal Information -->
            <div class="section">
                <h2>Personal Information</h2>
                <div class="form-group">
                    <label for="full_name">Full Name <span class="required">*</span></label>
                    <input type="text" id="full_name" name="full_name" value="{{ form_data.full_name if form_data else '' }}" required>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="highest_education">Highest Education <span class="required">*</span></label>
                        <input type="text" id="highest_education" name="highest_education" value="{{ form_data.highest_education if form_data else '' }}" required>
                    </div>
                    <div class="col">
                        <label for="city">City <span class="required">*</span></label>
                        <input type="text" id="city" name="city" value="{{ form_data.city if form_data else '' }}" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="phone">Phone <span class="required">*</span></label>
                        <input type="text" id="phone" name="phone" value="{{ form_data.phone if form_data else '' }}" required>
                    </div>
                    <div class="col">
                        <label for="email">Email <span class="required">*</span></label>
                        <input type="email" id="email" name="email" value="{{ form_data.email if form_data else '' }}" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label for="github">GitHub</label>
                        <input type="text" id="github" name="github" value="{{ form_data.github if form_data else '' }}" placeholder="e.g. https://github.com/amitsitare">
                    </div>
                    <div class="col">
                        <label for="linkedin">LinkedIn</label>
                        <input type="text" id="linkedin" name="linkedin" value="{{ form_data.linkedin if form_data else '' }}" placeholder="e.g. https://linkedin.com/in/amit-diwakar-cse">
                    </div>
                </div>
            </div>

            <!-- Summary -->
            <div class="section" id="summary-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Professional Summary</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('summary-section')">Remove Section</button>
                </div>
                <div class="form-group">
                    <label for="summary">Summary</label>
                    <textarea id="summary" name="summary" placeholder="Brief professional summary highlighting your key skills, experience, and career objectives..." rows="4">{{ form_data.summary if form_data else '' }}</textarea>
                </div>
            </div>

            <!-- Education -->
            <div class="section" id="education-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Educational Qualifications</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('education-section')">Remove Section</button>
                </div>
                <div id="education-container">
                    <div class="dynamic-entry">
                        <div class="entry-header">
                            <div class="entry-title">Education Entry 1 <span class="required">*</span></div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Qualification</label>
                                <input type="text" name="education[0][qualification]" required placeholder="e.g. B.Tech, M.Sc, 12th Grade">
                            </div>
                            <div class="col">
                                <label>Stream</label>
                                <input type="text" name="education[0][stream]" required placeholder="e.g. Computer Science, Science, Commerce">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Institute</label>
                                <input type="text" name="education[0][institute]" required placeholder="e.g. IIT Delhi, ABC School">
                            </div>
                            <div class="col">
                                <label>Year</label>
                                <input type="text" name="education[0][year]" required placeholder="e.g. 2024">
                            </div>
                            <div class="col">
                                <label>CGPA/%</label>
                                <input type="text" name="education[0][cgpa]" required placeholder="e.g. 8.5, 92%">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addEducationEntry()">+ Add Another Education</button>
                </div>
            </div>

            <!-- Achievements -->
            <div class="section" id="achievements-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Scholastic Achievements</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('achievements-section')">Remove Section</button>
                </div>
                <div id="achievements-container">
                    <div class="dynamic-entry">
                        <div class="entry-header">
                            <div class="entry-title">Achievement 1 <span class="required">*</span></div>
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea name="achievements[0][description]" required placeholder="e.g. Secured AIR 100 in JEE Advanced, Won Gold Medal in Olympiad"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Year</label>
                            <input type="text" name="achievements[0][year]" required placeholder="e.g. 2022">
                        </div>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addAchievementEntry()">+ Add Another Achievement</button>
                </div>
            </div>

            <!-- Internships -->
            <div class="section" id="internships-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Internships</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('internships-section')">Remove Section</button>
                </div>
                <div id="internships-container">
                    <div class="dynamic-entry">
                        <div class="entry-header">
                            <div class="entry-title">Internship 1 <span class="required">*</span></div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Company</label>
                                <input type="text" name="internships[0][company]" required placeholder="e.g. Google, Infosys">
                            </div>
                            <div class="col">
                                <label>Role</label>
                                <input type="text" name="internships[0][role]" required placeholder="e.g. Software Intern, Research Intern">
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="internships[0][duration]" required placeholder="e.g. May 2023 - July 2023">
                            </div>
                        </div>
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="internship-points" data-index="0">
                                <div class="point-entry">
                                    <textarea name="internships[0][points][]" placeholder="e.g. Developed a web app for internal use" required></textarea>
                                    <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                                </div>
                            </div>
                            <button type="button" class="btn-secondary" onclick="addInternshipPoint(0)">+ Add Point</button>
                        </div>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addInternshipEntry()">+ Add Another Internship</button>
                </div>
            </div>

            <!-- Projects -->
            <div class="section" id="projects-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Key Projects</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('projects-section')">Remove Section</button>
                </div>
                <div id="projects-container">
                    <div class="dynamic-entry">
                        <div class="entry-header">
                            <div class="entry-title">Project 1 <span class="required">*</span></div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Title</label>
                                <input type="text" name="projects[0][title]" required placeholder="e.g. Inventory Management System">
                            </div>
                            <div class="col">
                                <label>Type</label>
                                <input type="text" name="projects[0][type]" required placeholder="e.g. Web App, Research Project">
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="projects[0][duration]" required placeholder="e.g. Jan 2023 - Apr 2023">
                            </div>
                        </div>
                
                        <div class="form-group">
                            <label>Repo Link</label>
                            <input type="text" name="projects[0][repo_link]" placeholder="e.g. https://github.com/user/repo">
                        </div>
                
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="project-points" data-index="0">
                                <div class="point-entry">
                                    <textarea name="projects[0][points][]" placeholder="e.g. Built a REST API using Django" required></textarea>
                                    <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                                </div>
                            </div>
                            <button type="button" class="btn-secondary" onclick="addProjectPoint(0)">+ Add Point</button>
                        </div>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addProjectEntry()">+ Add Another Project</button>
                </div>
            </div>

            <!-- Positions of Responsibility -->
            <div class="section" id="positions-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Positions of Responsibility</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('positions-section')">Remove Section</button>
                </div>
                <div id="positions-container">
                    <div class="dynamic-entry">
                        <div class="entry-header">
                            <div class="entry-title">Position 1 <span class="required">*</span></div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Club/Organization</label>
                                <input type="text" name="positions[0][club]" required placeholder="e.g. Coding Club, IEEE">
                            </div>
                            <div class="col">
                                <label>Role</label>
                                <input type="text" name="positions[0][role]" required placeholder="e.g. Secretary, Coordinator">
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="positions[0][duration]" required placeholder="e.g. 2022-2023">
                            </div>
                        </div>
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="position-points" data-index="0">
                                <div class="point-entry">
                                    <textarea name="positions[0][points][]" placeholder="e.g. Organized a national level hackathon" required></textarea>
                                    <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                                </div>
                            </div>
                            <button type="button" class="btn-secondary" onclick="addPositionPoint(0)">+ Add Point</button>
                        </div>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addPositionEntry()">+ Add Another Position</button>
                </div>
            </div>

            <!-- Extra Curricular Activities -->
            <div class="section" id="extracurricular-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Extra Curricular Activities</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('extracurricular-section')">Remove Section</button>
                </div>
                <div id="activities-container">
                    <div class="activity-entry">
                        <textarea name="extracurricular[]" placeholder="e.g. Member of college football team" required></textarea>
                        <button type="button" class="btn-danger" onclick="removeActivity(this)">Remove</button>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addActivityEntry()">+ Add Another Activity</button>
                </div>
            </div>

            <!-- Technical Skills -->
            <div class="section" id="skills-section">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Technical Skills</h2>
                    <button type="button" class="btn-danger" onclick="removeSection('skills-section')">Remove Section</button>
                </div>
                <div id="skills-container">
                    <div class="skill-entry">
                        <input type="text" name="technical_skills[]" placeholder="e.g. Python, Java, SQL" required>
                        <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
                    </div>
                </div>
                <div class="add-button-container">
                    <button type="button" class="btn-secondary" onclick="addSkillEntry()">+ Add Another Skill</button>
                </div>
            </div>

            <button type="submit">Generate CV</button>
        </form>
    </div>
    </div>
    <div class="preview-section">
        <div id="cv-preview-container"></div>
    </div>
    </div>
    

    <script>
        // Counter for dynamic entries
        let educationCount = 1;
        let achievementCount = 1;
        let internshipCount = 1;
        let projectCount = 1;
        let positionCount = 1;

        // Education functions
        function addEducationEntry() {
            const container = document.getElementById('education-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'dynamic-entry';
            newEntry.innerHTML = `
                <div class="entry-header">
                    <div class="entry-title">Education Entry ${educationCount + 1}</div>
                    <button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>
                </div>
                <div class="row">
                    <div class="col">
                        <label>Qualification</label>
                        <input type="text" name="education[${educationCount}][qualification]" required>
                    </div>
                    <div class="col">
                        <label>Stream</label>
                        <input type="text" name="education[${educationCount}][stream]" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <label>Institute</label>
                        <input type="text" name="education[${educationCount}][institute]" required>
                    </div>
                    <div class="col">
                        <label>Year</label>
                        <input type="text" name="education[${educationCount}][year]" required>
                    </div>
                    <div class="col">
                        <label>CGPA/%</label>
                        <input type="text" name="education[${educationCount}][cgpa]" required>
                    </div>
                </div>
            `;
            container.appendChild(newEntry);
            educationCount++;
        }

        // Achievement functions
        function addAchievementEntry() {
            const container = document.getElementById('achievements-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'dynamic-entry';
            newEntry.innerHTML = `
                <div class="entry-header">
                    <div class="entry-title">Achievement ${achievementCount + 1}</div>
                    <button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea name="achievements[${achievementCount}][description]" required></textarea>
                </div>
                <div class="form-group">
                    <label>Year</label>
                    <input type="text" name="achievements[${achievementCount}][year]" required>
                </div>
            `;
            container.appendChild(newEntry);
            achievementCount++;
        }

        // Internship functions
        function addInternshipEntry() {
            const container = document.getElementById('internships-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'dynamic-entry';
            newEntry.innerHTML = `
                <div class="entry-header">
                    <div class="entry-title">Internship ${internshipCount + 1}</div>
                    <button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>
                </div>
                <div class="row">
                    <div class="col">
                        <label>Company</label>
                        <input type="text" name="internships[${internshipCount}][company]" required>
                    </div>
                    <div class="col">
                        <label>Role</label>
                        <input type="text" name="internships[${internshipCount}][role]" required>
                    </div>
                    <div class="col">
                        <label>Duration</label>
                        <input type="text" name="internships[${internshipCount}][duration]" required>
                    </div>
                </div>
                <div class="points-container">
                    <label>Key Points</label>
                    <div class="internship-points" data-index="${internshipCount}">
                        <div class="point-entry">
                            <textarea name="internships[${internshipCount}][points][]" placeholder="Key point 1" required></textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn-secondary" onclick="addInternshipPoint(${internshipCount})">+ Add Point</button>
                </div>
            `;
            container.appendChild(newEntry);
            internshipCount++;
        }

        function addInternshipPoint(index) {
            const container = document.querySelector(`.internship-points[data-index="${index}"]`);
            const newPoint = document.createElement('div');
            newPoint.className = 'point-entry';
            newPoint.innerHTML = `
                <textarea name="internships[${index}][points][]" placeholder="Key point" required></textarea>
                <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
            `;
            container.appendChild(newPoint);
        }

        // Project functions
        function addProjectEntry() {
            const container = document.getElementById('projects-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'dynamic-entry';
            newEntry.innerHTML = `
                <div class="entry-header">
                    <div class="entry-title">Project ${projectCount + 1}</div>
                    <button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>
                </div>
                <div class="row">
                    <div class="col">
                        <label>Title</label>
                        <input type="text" name="projects[${projectCount}][title]" required>
                    </div>
                    <div class="col">
                        <label>Type</label>
                        <input type="text" name="projects[${projectCount}][type]" required>
                    </div>
                    <div class="col">
                        <label>Duration</label>
                        <input type="text" name="projects[${projectCount}][duration]" required>
                    </div>
                </div>
                <div class="points-container">
                    <label>Key Points</label>
                    <div class="project-points" data-index="${projectCount}">
                        <div class="point-entry">
                            <textarea name="projects[${projectCount}][points][]" placeholder="Key point 1" required></textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn-secondary" onclick="addProjectPoint(${projectCount})">+ Add Point</button>
                </div>
            `;
            container.appendChild(newEntry);
            projectCount++;
        }

        function addProjectPoint(index) {
            const container = document.querySelector(`.project-points[data-index="${index}"]`);
            const newPoint = document.createElement('div');
            newPoint.className = 'point-entry';
            newPoint.innerHTML = `
                <textarea name="projects[${index}][points][]" placeholder="Key point" required></textarea>
                <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
            `;
            container.appendChild(newPoint);
        }

        // Position functions
        function addPositionEntry() {
            const container = document.getElementById('positions-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'dynamic-entry';
            newEntry.innerHTML = `
                <div class="entry-header">
                    <div class="entry-title">Position ${positionCount + 1}</div>
                    <button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>
                </div>
                <div class="row">
                    <div class="col">
                        <label>Club/Organization</label>
                        <input type="text" name="positions[${positionCount}][club]" required>
                    </div>
                    <div class="col">
                        <label>Role</label>
                        <input type="text" name="positions[${positionCount}][role]" required>
                    </div>
                    <div class="col">
                        <label>Duration</label>
                        <input type="text" name="positions[${positionCount}][duration]" required>
                    </div>
                </div>
                <div class="points-container">
                    <label>Key Points</label>
                    <div class="position-points" data-index="${positionCount}">
                        <div class="point-entry">
                            <textarea name="positions[${positionCount}][points][]" placeholder="Key point 1" required></textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    </div>
                    <button type="button" class="btn-secondary" onclick="addPositionPoint(${positionCount})">+ Add Point</button>
                </div>
            `;
            container.appendChild(newEntry);
            positionCount++;
        }

        function addPositionPoint(index) {
            const container = document.querySelector(`.position-points[data-index="${index}"]`);
            const newPoint = document.createElement('div');
            newPoint.className = 'point-entry';
            newPoint.innerHTML = `
                <textarea name="positions[${index}][points][]" placeholder="Key point" required></textarea>
                <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
            `;
            container.appendChild(newPoint);
        }

        // Activity functions
        function addActivityEntry() {
            const container = document.getElementById('activities-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'activity-entry';
            newEntry.innerHTML = `
                <textarea name="extracurricular[]" placeholder="Activity" required></textarea>
                <button type="button" class="btn-danger" onclick="removeActivity(this)">Remove</button>
            `;
            container.appendChild(newEntry);
        }

        function removeActivity(button) {
            button.parentElement.remove();
        }

        // Skill functions
        function addSkillEntry() {
            const container = document.getElementById('skills-container');
            const newEntry = document.createElement('div');
            newEntry.className = 'skill-entry';
            newEntry.innerHTML = `
                <input type="text" name="technical_skills[]" placeholder="Skill" required>
                <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
            `;
            container.appendChild(newEntry);
        }

        function removeSkill(button) {
            button.parentElement.remove();
        }

        // Generic remove functions
        function removeEntry(button) {
            button.closest('.dynamic-entry').remove();
        }

        function removePoint(button) {
            button.parentElement.remove();
        }

        function removeSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.remove();
            }
        }

        // Pre-populate form with test data if available
{% if form_data %}
        window.addEventListener('DOMContentLoaded', function() {
            populateFormWithTestData();
        });

        function populateFormWithTestData() {
            const formData = {{ form_data | tojson }};
            
            // Personal info
            if (formData.personal_info) {
                document.getElementById('full_name').value = formData.personal_info.full_name || '';
                document.getElementById('highest_education').value = formData.personal_info.highest_education || '';
                document.getElementById('city').value = formData.personal_info.city || '';
                document.getElementById('phone').value = formData.personal_info.phone || '';
                document.getElementById('email').value = formData.personal_info.email || '';
                document.getElementById('github').value = formData.personal_info.github || '';
                document.getElementById('linkedin').value = formData.personal_info.linkedin || '';
            }
            
            // Education
            if (formData.education && formData.education.length > 0) {
                const eduContainer = document.getElementById('education-container');
                eduContainer.innerHTML = '';
                educationCount = 0;
                
                formData.education.forEach((edu, index) => {
                    const entry = document.createElement('div');
                    entry.className = 'dynamic-entry';
                    entry.innerHTML = `
                        <div class="entry-header">
                            <div class="entry-title">Education Entry ${index + 1} ${index === 0 ? '<span class="required">*</span>' : ''}</div>
                            ${index > 0 ? '<button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>' : ''}
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Qualification</label>
                                <input type="text" name="education[${index}][qualification]" value="${edu.qualification || ''}" required>
                            </div>
                            <div class="col">
                                <label>Stream</label>
                                <input type="text" name="education[${index}][stream]" value="${edu.stream || ''}" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Institute</label>
                                <input type="text" name="education[${index}][institute]" value="${edu.institute || ''}" required>
                            </div>
                            <div class="col">
                                <label>Year</label>
                                <input type="text" name="education[${index}][year]" value="${edu.year || ''}" required>
                            </div>
                            <div class="col">
                                <label>CGPA/%</label>
                                <input type="text" name="education[${index}][cgpa]" value="${edu.cgpa || ''}" required>
                            </div>
                        </div>
                    `;
                    eduContainer.appendChild(entry);
                    educationCount++;
                });
            }
            
            // Achievements
            if (formData.achievements && formData.achievements.length > 0) {
                const achContainer = document.getElementById('achievements-container');
                achContainer.innerHTML = '';
                achievementCount = 0;
                
                formData.achievements.forEach((ach, index) => {
                    const entry = document.createElement('div');
                    entry.className = 'dynamic-entry';
                    entry.innerHTML = `
                        <div class="entry-header">
                            <div class="entry-title">Achievement ${index + 1} ${index === 0 ? '<span class="required">*</span>' : ''}</div>
                            ${index > 0 ? '<button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>' : ''}
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea name="achievements[${index}][description]" required>${ach.description || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label>Year</label>
                            <input type="text" name="achievements[${index}][year]" value="${ach.year || ''}" required>
                        </div>
                    `;
                    achContainer.appendChild(entry);
                    achievementCount++;
                });
            }
            
            // Internships
            if (formData.internships && formData.internships.length > 0) {
                const internContainer = document.getElementById('internships-container');
                internContainer.innerHTML = '';
                internshipCount = 0;
                
                formData.internships.forEach((intern, index) => {
                    const pointsHtml = intern.points ? intern.points.map(point => `
                        <div class="point-entry">
                            <textarea name="internships[${index}][points][]" placeholder="Key point" required>${point}</textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    `).join('') : '';
                    
                    const entry = document.createElement('div');
                    entry.className = 'dynamic-entry';
                    entry.innerHTML = `
                        <div class="entry-header">
                            <div class="entry-title">Internship ${index + 1} ${index === 0 ? '<span class="required">*</span>' : ''}</div>
                            ${index > 0 ? '<button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>' : ''}
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Company</label>
                                <input type="text" name="internships[${index}][company]" value="${intern.company || ''}" required>
                            </div>
                            <div class="col">
                                <label>Role</label>
                                <input type="text" name="internships[${index}][role]" value="${intern.role || ''}" required>
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="internships[${index}][duration]" value="${intern.duration || ''}" required>
                            </div>
                        </div>
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="internship-points" data-index="${index}">
                                ${pointsHtml}
                            </div>
                            <button type="button" class="btn-secondary" onclick="addInternshipPoint(${index})">+ Add Point</button>
                        </div>
                    `;
                    internContainer.appendChild(entry);
                    internshipCount++;
                });
            }
            
            // Projects
            if (formData.projects && formData.projects.length > 0) {
                const projContainer = document.getElementById('projects-container');
                projContainer.innerHTML = '';
                projectCount = 0;
                
                formData.projects.forEach((proj, index) => {
                    const pointsHtml = proj.points ? proj.points.map(point => `
                        <div class="point-entry">
                            <textarea name="projects[${index}][points][]" placeholder="Key point" required>${point}</textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    `).join('') : '';
                    
                    const entry = document.createElement('div');
                    entry.className = 'dynamic-entry';
                    entry.innerHTML = `
                        <div class="entry-header">
                            <div class="entry-title">Project ${index + 1} ${index === 0 ? '<span class="required">*</span>' : ''}</div>
                            ${index > 0 ? '<button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>' : ''}
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Title</label>
                                <input type="text" name="projects[${index}][title]" value="${proj.title || ''}" required>
                            </div>
                            <div class="col">
                                <label>Type</label>
                                <input type="text" name="projects[${index}][type]" value="${proj.type || ''}" required>
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="projects[${index}][duration]" value="${proj.duration || ''}" required>
                            </div>
                        </div>
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="project-points" data-index="${index}">
                                ${pointsHtml}
                            </div>
                            <button type="button" class="btn-secondary" onclick="addProjectPoint(${index})">+ Add Point</button>
                        </div>
                    `;
                    projContainer.appendChild(entry);
                    projectCount++;
                });
            }
            
            // Positions of Responsibility
            if (formData.positions_of_responsibility && formData.positions_of_responsibility.length > 0) {
                const posContainer = document.getElementById('positions-container');
                posContainer.innerHTML = '';
                positionCount = 0;
                
                formData.positions_of_responsibility.forEach((pos, index) => {
                    const pointsHtml = pos.points ? pos.points.map(point => `
                        <div class="point-entry">
                            <textarea name="positions[${index}][points][]" placeholder="Key point" required>${point}</textarea>
                            <button type="button" class="btn-danger" onclick="removePoint(this)">Remove</button>
                        </div>
                    `).join('') : '';
                    
                    const entry = document.createElement('div');
                    entry.className = 'dynamic-entry';
                    entry.innerHTML = `
                        <div class="entry-header">
                            <div class="entry-title">Position ${index + 1} ${index === 0 ? '<span class="required">*</span>' : ''}</div>
                            ${index > 0 ? '<button type="button" class="btn-danger" onclick="removeEntry(this)">Remove</button>' : ''}
                        </div>
                        <div class="row">
                            <div class="col">
                                <label>Club/Organization</label>
                                <input type="text" name="positions[${index}][club]" value="${pos.club || ''}" required>
                            </div>
                            <div class="col">
                                <label>Role</label>
                                <input type="text" name="positions[${index}][role]" value="${pos.role || ''}" required>
                            </div>
                            <div class="col">
                                <label>Duration</label>
                                <input type="text" name="positions[${index}][duration]" value="${pos.duration || ''}" required>
                            </div>
                        </div>
                        <div class="points-container">
                            <label>Key Points</label>
                            <div class="position-points" data-index="${index}">
                                ${pointsHtml}
                            </div>
                            <button type="button" class="btn-secondary" onclick="addPositionPoint(${index})">+ Add Point</button>
                        </div>
                    `;
                    posContainer.appendChild(entry);
                    positionCount++;
                });
            }
            
            // Extracurricular Activities
            if (formData.extracurricular && formData.extracurricular.length > 0) {
                const actContainer = document.getElementById('activities-container');
                actContainer.innerHTML = '';
                
                formData.extracurricular.forEach((activity, index) => {
                    const entry = document.createElement('div');
                    entry.className = 'activity-entry';
                    entry.innerHTML = `
                        <textarea name="extracurricular[]" placeholder="Activity" required>${activity}</textarea>
                        <button type="button" class="btn-danger" onclick="removeActivity(this)">Remove</button>
                    `;
                    actContainer.appendChild(entry);
                });
            }
            
            // Technical Skills
            if (formData.technical_skills && formData.technical_skills.length > 0) {
                const skillContainer = document.getElementById('skills-container');
                skillContainer.innerHTML = '';
                
                formData.technical_skills.forEach((skill, index) => {
                    const entry = document.createElement('div');
                    entry.className = 'skill-entry';
                    entry.innerHTML = `
                        <input type="text" name="technical_skills[]" placeholder="Skill" value="${skill}" required>
                        <button type="button" class="btn-danger" onclick="removeSkill(this)">Remove</button>
                    `;
                    skillContainer.appendChild(entry);
                });
            }
        }
{% endif %}

        // Personal Information placeholders
        window.addEventListener('DOMContentLoaded', function() {
            var fullName = document.getElementById('full_name');
            if (fullName) fullName.setAttribute('placeholder', 'e.g. Jane Doe');
            var highestEducation = document.getElementById('highest_education');
            if (highestEducation) highestEducation.setAttribute('placeholder', 'e.g. B.Tech, M.Sc, 12th Grade');
            var city = document.getElementById('city');
            if (city) city.setAttribute('placeholder', 'e.g. New Delhi');
            var phone = document.getElementById('phone');
            if (phone) phone.setAttribute('placeholder', 'e.g. 9876543210');
            var email = document.getElementById('email');
            if (email) email.setAttribute('placeholder', 'e.g. jane.doe@email.com');
        });
    function getValue(name) {
        const el = document.getElementById('cvForm').elements[name];
        return el ? el.value.trim() : '';
    }
    function getValues(name) {
        return Array.from(document.querySelectorAll(`#cvForm [name^="${name}"]`)).map(e => e.value.trim()).filter(Boolean);
    }
    function renderPreview() {
        const preview = document.getElementById('cv-preview-container');
        let html = '<div class="cv-preview" style="font-family: Times New Roman, Times, serif; max-width: 794px; min-height: 1123px; background: #fff; padding: 32px; box-sizing: border-box;">';
        
        // Personal Info
        const name = getValue('full_name');
        const degree = getValue('highest_education');
        const city = getValue('city');
        const phone = getValue('phone');
        const email = getValue('email');
        const github = getValue('github');
        const linkedin = getValue('linkedin');
        
        // Get institute from first education entry for header
        const educationEntries = getArrayEntries('education');
        const firstEducation = educationEntries.length > 0 ? educationEntries[0] : {};
        const institute = firstEducation.institute || '';
        
        // Header
        if (name) html += `<div style="font-size:2.2em;font-weight:bold;color:#4C5196;text-align:center;margin-bottom:8px;">${name}</div>`;
        if (degree || institute) {
            html += `<div style="text-align:center;font-size:1.1em;margin-bottom:8px;">`;
            if (degree) html += `${degree}`;
            if (degree && institute) html += `, `;
            if (institute) html += `${institute}`;
            html += '</div>';
        }
        // Contact info line (icons, links, profile id)
        html += `<div style="display:flex;flex-wrap:nowrap;align-items:center;justify-content:center;gap:8px;white-space:nowrap;overflow-x:auto;font-size:1.1em;margin-bottom:8px;">`;
        let contactParts = [];
        if (city) contactParts.push(`<span>${city}</span>`);
        if (phone) contactParts.push(`<span style='display:inline-flex;align-items:center;gap:2px;'><svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="vertical-align:middle;" xmlns="http://www.w3.org/2000/svg"><path d="M6.62 10.79a15.053 15.053 0 006.59 6.59l2.2-2.2a1 1 0 011.01-.24c1.12.37 2.33.57 3.58.57a1 1 0 011 1V20a1 1 0 01-1 1C10.07 21 3 13.93 3 5a1 1 0 011-1h3.5a1 1 0 011 1c0 1.25.2 2.46.57 3.58a1 1 0 01-.24 1.01l-2.2 2.2z" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> ${phone}</span>`);
        if (email) contactParts.push(`<span style='display:inline-flex;align-items:center;gap:2px;'><a href="mailto:${email}" style="vertical-align:middle; text-decoration:none;"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="vertical-align:middle;" xmlns="http://www.w3.org/2000/svg"><path d="M4 4h16v16H4V4zm0 0l8 8 8-8" stroke="#222" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> ${email}</a></span>`);
        if (github) {
            let githubId = github.replace(/\/$/, '').split('/').pop();
            contactParts.push(`<span style='display:inline-flex;align-items:center;gap:2px;'><a href="${github}" target="_blank" style="vertical-align:middle; text-decoration:none;"><svg height="16" width="16" viewBox="0 0 16 16" fill="currentColor" style="vertical-align:middle;"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg> ${githubId}</a></span>`);
        }
        if (linkedin) {
            let linkedinId = linkedin.replace(/\/$/, '').split('/').pop();
            const linkedInSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#0A66C2" viewBox="0 0 24 24" style="vertical-align: middle;"><path d="M20.447 20.452h-3.554v-5.569c0-1.327-.025-3.037-1.849-3.037-1.851 0-2.132 1.445-2.132 2.939v5.667h-3.554V9h3.414v1.561h.049c.476-.899 1.637-1.849 3.369-1.849 3.602 0 4.267 2.369 4.267 5.455v6.285zM5.337 7.433c-1.144 0-2.069-.926-2.069-2.068 0-1.143.925-2.069 2.069-2.069 1.143 0 2.068.926 2.068 2.069 0 1.142-.925 2.068-2.068 2.068zm1.777 13.019H3.56V9h3.554v11.452zM22.225 0H1.771C.792 0 0 .771 0 1.723v20.549C0 23.229.792 24 1.771 24h20.451C23.2 24 24 23.229 24 22.271V1.723C24 .771 23.2 0 22.222 0z"/></svg>`;
            contactParts.push(`<span style='display:inline-flex;align-items:center;gap:2px;'><a href="${linkedin}" target="_blank" style="vertical-align:middle; text-decoration:none;">${linkedInSVG} ${linkedinId}</a></span>`);
        }
        html += contactParts.join(' <span style="color:#888;">|</span> ');
        html += `</div>`;
        // Simple horizontal line after contact info
        html += `<div style="border-bottom: 2px solid #333; margin-bottom: 20px;"></div>`;
      const summary = getValue('summary');
      // Professional Summary
        if (summary && summary.trim()) {
            html += `<div style="margin-bottom:20px;">
                <div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Professional Summary
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div>
                <div style="font-size:12px;line-height:1.4;text-align:justify;">${summary}</div>
            </div>`;
        }

        // Education
        if (educationEntries.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Educational Qualifications
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div>`;
            

            html += `<table style="width:100%;border-collapse:collapse;font-size:0.9em;margin-bottom:10px;">`;
            html += `<thead><tr style="background:#f5f5f5;">`;
            html += `<th style="border:1px solid #ddd;padding:8px;text-align:left;">Qualification</th>`;
            html += `<th style="border:1px solid #ddd;padding:8px;text-align:left;">Stream</th>`;
            html += `<th style="border:1px solid #ddd;padding:8px;text-align:left;">Institute</th>`;
            html += `<th style="border:1px solid #ddd;padding:8px;text-align:left;">Year</th>`;
            html += `<th style="border:1px solid #ddd;padding:8px;text-align:left;">CGPA/%</th>`;
            html += `</tr></thead><tbody>`;
            
            educationEntries.forEach(entry => {
                if (entry.qualification || entry.stream || entry.institute) {
                    html += `<tr>`;
                    html += `<td style="border:1px solid #ddd;padding:8px;">${entry.qualification || ''}</td>`;
                    html += `<td style="border:1px solid #ddd;padding:8px;">${entry.stream || ''}</td>`;
                    html += `<td style="border:1px solid #ddd;padding:8px;">${entry.institute || ''}</td>`;
                    html += `<td style="border:1px solid #ddd;padding:8px;">${entry.year || ''}</td>`;
                    html += `<td style="border:1px solid #ddd;padding:8px;">${entry.cgpa || ''}</td>`;
                    html += `</tr>`;
                }
            });

            html += `</tbody></table></div>`;
        }

      // Scholastic Achievements
        const achievementEntries = getArrayEntries('achievements');
        if (achievementEntries.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Scholastic Achievements
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div> `;
           

            
            // Increase margin-left for more bullet indentation
            html += `<ul style="margin:0 0 0 20px;list-style-type:disc;">`;

            achievementEntries.forEach(entry => {
                if (entry.description) {
                    html += `<li style="margin-bottom:8px;">`;

                    // Inner div flex inside li, not span
                    html += `<div style="display:flex;justify-content:space-between;align-items:center;">`;
                    html += `<span>${entry.description}</span>`;
                    if (entry.year) {
                        html += `<span style="font-style:italic;margin-left:10px;">(${entry.year})</span>`;
                    }
                    html += `</div></li>`;
                }
            });

            html += `</ul></div>`;
        }



        // Internships
       const internshipEntries = getArrayEntries('internships');
        if (internshipEntries.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Internships
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div> `;
            

            internshipEntries.forEach(entry => {
                if (entry.company || entry.role) {
                    html += `<div style="margin-bottom:15px;">`;

                    // Company and role in flex box
                    html += `<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px;">`;
                    html += `<div><strong>${entry.company || ''}</strong>`;
                    if (entry.role) html += ` | ${entry.role}`;
                    html += `</div>`;
                    if (entry.duration) html += `<div style="font-style:italic;">(${entry.duration})</div>`;
                    html += `</div>`;

                    // Bullet points with proper list styling
                    if (entry.points && entry.points.length > 0) {
                        html += `<ul style="margin:0 0 0 20px;list-style-type:disc;">`;
                        entry.points.forEach(point => {
                            if (point.trim()) {
                                html += `<li style="margin-bottom:5px;">${point}</li>`;
                            }
                        });
                        html += `</ul>`;
                    }

                    html += `</div>`;
                }
            });
            html += `</div>`;
        }

        // Key Projects
        const projectEntries = getArrayEntries('projects');
        if (projectEntries.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Key Projects
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div> `;
            
            
            
            projectEntries.forEach(entry => {
                if (entry.title || entry.type) {
                    html += `<div style="margin-bottom:10px;display:flex;justify-content:space-between;align-items:flex-start;">`;
                    
                    html += `<div><span style="font-weight:bold;">`;
                    if (entry.repo_link) {
                        html += `<a href="${entry.repo_link}" target="_blank">${entry.title}</a>`;
                    } else {
                        html += `${entry.title}`;
                    }
                    html += `</span>${entry.type ? ` | ${entry.type}` : ''}</div>`;
                    
                    if (entry.duration) {
                        html += `<div style="font-style:italic;">(${entry.duration})</div>`;
                    }

                    html += `</div>`;

                    // Bullet points
                    if (entry.points && entry.points.length > 0) {
                        html += `<ul style="margin:0 0 0 20px;list-style-type:disc;">`;
                        entry.points.forEach(point => {
                            if (point.trim()) {
                                html += `<li style="margin-bottom:5px;">${point}</li>`;
                            }
                        });
                        html += `</ul>`;
                    }
                }
            });

            html += `</div>`;
        }


        // Positions of Responsibility
       const positionEntries = getArrayEntries('positions');
        if (positionEntries.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
            <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                Positions of Responsibility
            </div>
            <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
           </div>`; 
            
            positionEntries.forEach(entry => {
                if (entry.club || entry.role) {
                    html += `<div style="margin-bottom:15px;">`;
                    
                    html += `<div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:5px;">`;
                    html += `<div><strong>${entry.club || ''}</strong>`;
                    if (entry.role) html += ` | ${entry.role}`;
                    html += `</div>`;
                    if (entry.duration) html += `<div style="font-style:italic;">(${entry.duration})</div>`;
                    html += `</div>`;

                    if (entry.points && entry.points.length > 0) {
                        html += `<ul style="margin:0 0 0 20px;list-style-type:disc;">`;
                        entry.points.forEach(point => {
                            if (point.trim()) html += `<li style="margin-bottom:5px;">${point}</li>`;
                        });
                        html += `</ul>`;
                    }

                    html += `</div>`;
                }
            });

            html += `</div>`;
        }

       // Extra Curricular Activities
        const activities = getArrayValues('extracurricular_activities');
        if (activities.length > 0) {
            html += `<div style="margin-bottom:20px;">`;

            // Updated heading style with horizontal line
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                    <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                        Extra Curricular Activities
                    </div>
                    <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
                </div> `;
            

            // Bullet points list
            html += `<ul style="margin:0 0 0 20px;list-style-type:disc;">`;
            activities.forEach(activity => {
                if (activity.trim()) {
                    html += `<li style="margin-bottom:5px;">${activity}</li>`;
                }
            });
            html += `</ul></div>`;
        }



        // Technical Skills (at bottom)
        const skills = getArrayValues('technical_skills');
        if (skills.length > 0) {
            html += `<div style="margin-bottom:20px;">`;
            html += `<div style="display:flex;align-items:center;margin-bottom:10px;">
                <div style="font-weight:bold;color:#4C5196;font-size:1.1em;margin-right:10px;white-space:nowrap;">
                    Technical Skills
                </div>
                <div style="flex-grow:1;height:1px;background-color:#4C5196;"></div>
            </div> `;
       

            html += `<div style="line-height:1.6;">${skills.filter(s => s.trim()).join(', ')}</div></div>`;
        }

        html += '</div>';
        preview.innerHTML = html;
    }
    document.getElementById('cvForm').addEventListener('input', renderPreview);
    window.addEventListener('DOMContentLoaded', renderPreview);

    // Helper functions for getting form data
    function getValue(id) {
        const element = document.getElementById(id);
        return element ? element.value : '';
    }

    function getArrayValues(fieldName) {
        // Handle different field name patterns
        let selector;
        if (fieldName === 'achievements') {
            selector = '[name="achievements[]"]';
        } else if (fieldName === 'technical_skills') {
            selector = '[name="technical_skills[]"]';
        } else if (fieldName === 'extracurricular_activities') {
            selector = '[name="extracurricular[]"]';
        } else {
            selector = `[name^="${fieldName}"]`;
        }
        
        const inputs = document.querySelectorAll(selector);
        return Array.from(inputs).map(input => input.value).filter(val => val && val.trim());
    }

    function getArrayEntries(sectionName) {
        const entries = [];
        const form = document.getElementById('cvForm');
        const formData = new FormData(form);
        
        // Group entries by index
        const grouped = {};
        for (let [key, value] of formData.entries()) {
            if (key.startsWith(`${sectionName}[`)) {
                const match = key.match(/\[(\d+)\]\[([^\]]+)\]/);
                if (match) {
                    const index = match[1];
                    const field = match[2];
                    if (!grouped[index]) grouped[index] = {};
                    if (field === 'points') {
                        if (!grouped[index].points) grouped[index].points = [];
                        grouped[index].points.push(value);
                    } else {
                        grouped[index][field] = value;
                    }
                }
            }
        }
        
        return Object.values(grouped);
    }
    </script>
</body>
</html>





